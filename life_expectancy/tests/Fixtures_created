import pandas as pd
from life_expectancy.cleaning import clean_data, save_data

# Input Fixture
def create_input_fixture():
    # Load raw data
    raw_data = pd.read_csv('life_expectancy\data\eu_life_expectancy_raw.tsv', delimiter='\t')

    # Create a sample (modify as needed)
    input_sample = raw_data.sample(n=5, random_state=42)

    # Save the sample as the input fixture
    input_sample.to_csv('life_expectancy\tests\fixtures\eu_life_expectancy_raw.tsv', index=False)

# Expected Fixture
def create_expected_fixture():
    # Load the input fixture
    input_fixture = pd.read_csv('life_expectancy\tests\fixtures\eu_life_expectancy_raw.tsv')

    # Use your code to generate the expected output
    expected_output = clean_data(input_fixture, region=None)  # Modify the arguments as needed
    save_data(expected_output, filename='life_expectancy\tests\fixtures\eu_life_expectancy_expected.csv')

if __name__ == "__main__":
    create_input_fixture()
    create_expected_fixture()
